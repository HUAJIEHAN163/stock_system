# 控制台日志使用说明

## 📋 概述

股票分析系统现在支持在启动GUI的同时显示控制台日志，方便用户实时查看系统运行状态和调试信息。

## 🚀 启动方式

### 方式1: 批处理文件启动（推荐）
双击运行 `启动系统(带日志).bat` 文件

### 方式2: Python脚本启动
```bash
python launch_gui_with_console.py
```

### 方式3: 测试日志功能
```bash
python test_console_log.py
```

## 📊 日志功能特点

### 控制台日志
- ✅ 实时显示系统运行状态
- ✅ 显示用户操作记录
- ✅ 显示错误和警告信息
- ✅ 支持中文显示
- ✅ 独立的控制台窗口

### 文件日志
- ✅ 自动保存到 `logs/` 目录
- ✅ 按日期命名：`stock_system_YYYYMMDD.log`
- ✅ UTF-8编码，支持中文
- ✅ 包含时间戳和详细信息

## 🔍 日志级别

- **INFO**: 一般信息，如系统启动、功能操作等
- **WARNING**: 警告信息，如配置问题、性能提醒等
- **ERROR**: 错误信息，如API调用失败、数据处理错误等

## 📝 日志格式

```
时间戳 - 模块名 - 级别 - 消息内容
```

示例：
```
2024-12-19 10:30:15,123 - StockSystem.MainWindow - INFO - 主窗口初始化完成
2024-12-19 10:30:16,456 - StockSystem.MainWindow - INFO - 股票选择事件: 000001.SZ
```

## 🛠️ 使用建议

### 开发调试时
1. 使用 `启动系统(带日志).bat` 启动
2. 保持控制台窗口打开
3. 观察实时日志输出
4. 遇到问题时查看错误日志

### 正常使用时
1. 可以使用 `python run.py` 标准启动
2. 日志仍会保存到文件中
3. 需要时可查看日志文件

## 📁 日志文件位置

- **目录**: `logs/`
- **文件名**: `stock_system_YYYYMMDD.log`
- **编码**: UTF-8
- **轮转**: 按日期自动创建新文件

## ❓ 常见问题

### Q: 控制台窗口可以关闭吗？
A: 可以关闭，不会影响GUI程序运行，但会失去实时日志查看功能。

### Q: 日志文件会占用很多空间吗？
A: 日志文件按日期分割，可以定期清理旧的日志文件。

### Q: 如何调整日志级别？
A: 修改 `src/main.py` 中的 `logging.basicConfig` 设置。

### Q: 控制台显示乱码怎么办？
A: 确保控制台支持UTF-8编码，Windows系统会自动设置。

## 🔧 技术实现

### Windows控制台分配
```python
import ctypes
kernel32 = ctypes.windll.kernel32
kernel32.AllocConsole()
```

### 输出重定向
```python
sys.stdout = open('CONOUT$', 'w', encoding='utf-8')
sys.stderr = open('CONOUT$', 'w', encoding='utf-8')
```

### 日志配置
```python
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('logs/stock_system.log', encoding='utf-8'),
        logging.StreamHandler(sys.stdout)
    ]
)
```

## 📞 技术支持

如果遇到日志相关问题，请：
1. 检查 `logs/` 目录是否存在
2. 确认Python版本支持（3.8+）
3. 查看控制台错误信息
4. 检查文件权限设置

---

*最后更新: 2024年12月*